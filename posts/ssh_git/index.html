<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=HandheldFriendly content="True"><meta http-equiv=x-ua-compatible content="IE=edge"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=generator content="Hugo 0.105.0"><link rel="shortcut icon" href=/images/angela.jpg><title>Set up your own Git server with SSH service - Blog of retrhelo</title><meta name=author content="retrhelo"><meta name=keywords content="network"><meta property="og:title" content="Set up your own Git server with SSH service"><meta name=twitter:title content="Set up your own Git server with SSH service"><meta property="og:type" content="article"><meta property="og:url" content="https://retrhelo.github.io/posts/ssh_git/"><meta property="og:description" content="This article introduces how to set up a Git server at your own remote machine.
Git repository can be easily set up at local machine, referred to by its path.
The approach applied almostly the same when it comes to a remote server,
requiring only the SSH service as the extra stuff."><meta name=twitter:description content="This article introduces how to set up a Git server at your own remote machine.
Git repository can be easily set up at local machine, referred to by its path.
The approach applied almostly the same when it comes to a remote server,
requiring only the SSH service as the extra stuff."><meta name=twitter:card content="summary"><meta property="article:published_time" content="2022-11-14T10:27:02+08:00"><meta property="article:modified_time" content="2022-11-14T10:27:02+08:00"><style>@media(prefers-color-scheme:dark){body[data-theme=auto] img{filter:brightness(60%)}}body[data-theme=dark] img{filter:brightness(60%)}</style><link rel=stylesheet href=https://retrhelo.github.io/assets/css/fuji.min.css></head><body data-theme=auto data-theme-auto=true><script data-cfasync=false>var fujiThemeData=localStorage.getItem("fuji_data-theme");fujiThemeData?fujiThemeData!=="auto"&&document.body.setAttribute("data-theme",fujiThemeData==="dark"?"dark":"light"):localStorage.setItem("fuji_data-theme","auto")</script><header><div class="container-lg clearfix"><div class="col-12 header"><a class=title-main href=https://retrhelo.github.io>Blog of retrhelo</a>
<span class=title-sub>Peace within.</span></div></div></header><main><div class="container-lg clearfix"><div class="col-12 col-md-9 float-left content"><article><h2 class="post-item post-title"><a href=https://retrhelo.github.io/posts/ssh_git/>Set up your own Git server with SSH service</a></h2><div class="post-item post-meta"><span><i class="iconfont icon-today-sharp"></i>&nbsp;2022-11-14</span>
<span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href=/tags/network>network</a>&nbsp;</span></div><div class="post-content markdown-body"><p>This article introduces how to set up a Git server at your own remote machine.
Git repository can be easily set up at local machine, referred to by its path.
The approach applied almostly the same when it comes to a remote server,
requiring only the SSH service as the extra stuff.</p><h2 id=ssh-server>SSH Server</h2><p>SSH service is quite common for remote servers, especially whose running Linux.
It gives users the access to interact with the server via command line shell,
which pretty much feels the same as Linux running locally.</p><p>SSH service also enables data transfer between the server and your client
machine. Commands like <code>scp</code> uses SSH as an approach to copy files through the
network.</p><h3 id=configure-the-ssh-server>Configure the SSH server</h3><p>There&rsquo;re some configurations to be done before we head for Git. First, you
should have a passwordless access to your server via SSH. If you&rsquo;re not,
there&rsquo;re plenty of tutorials online. Google and check it out.</p><h2 id=set-up-git-server>Set up Git server</h2><p>The way to set up a Git repository at the remote machine is pretty much the same
as it&rsquo;s at local: create a folder and <code>git init</code> it. Let&rsquo;s say we create a Git
repository in <code>/data/git/repo_example</code>. In the local case, you can easily clone
the repository with <code>git clone /data/git/repo_example</code>, with Git remote set as
<code>/data/git/repo_example</code>.</p><p>As the rule changes little with a remote SSH access. The command to clone is now
<code>git clone ssh://alice@1.2.3.4:2222/data/git/repo_example</code> (In this example, we
assume <code>1.2.3.4</code> as the IP address of the remote machine, <code>2222</code> as the port
where sshd listens, and <code>alice</code> as the username).</p><h3 id=configure-the-file-permission>Configure the file permission</h3><p>However, you may not be able to clone the repository down to your local machine,
or later not be able to push your commits. That&rsquo;s because the your remtoe
account doesn&rsquo;t have the right read/write permission.</p><p>Linux uses three classes of file permissions: user, group and other, and each
class contains three types: read, write and execute (marked as <code>rwx</code>). To clone
the repository with account <code>alice</code>, <code>alice</code> must have a write permission to it.
And to push, <code>alice</code> must have the write permission.</p><p>It&rsquo;s recommended letting a special user, say <code>git</code>, to have the read/write
permission of your remote Git directory. And user <code>git</code> would be managing all
Git repositories at the server. Repositories can be cloned via the unified user
<code>git</code>.</p><p>However, this approach requires to setup passwordless login every time adding a
new user. And it&rsquo;s hard to trace the creator/modifier of certain files. And
since every one is as the user <code>git</code>, it&rsquo;s difficult to create a finer-grained
permission control among users.</p><p>I make use of the permission group system that comes with Linux. My scheme is to
have the group own the directory (In our case, it&rsquo;s <code>/data/git</code>), and every one
involved is added to the group. The group has the read/write permission, so does
its members. By this way, every one can access the repositories from their own
accounts, and the access permission is directly controlled by the groups that
they&rsquo;re in.</p><h3 id=set-the-directory-suitable-for-multi-user-environment>Set the directory suitable for multi-user environment</h3><p>With multiple users involved, you would want every file created in the
repositories belong to the very group that owns its repository. Unfortunately,
if not configured, the file by default belongs the creator&rsquo;s group (the one
that&rsquo;s created sharing the same name with the user). It leads to permission
problems when multiple users are trying to push/pull commits to/from the
repository (since not every one belongs the creator&rsquo;s group).</p><p>To solve this problem, we must change the default group for all files created in
it. It&rsquo;s done by command <code>chmod g+s &lt;directory></code>. For example, if <code>/data/git</code>
belongs to group <code>git</code>, then <code>chmod g+s /data/git</code> makes every subdirectories
created later in it belong to <code>git</code>, too. And these subdirectories adopt this
attribute.</p><p>It&rsquo;s worth attention that <code>chmod g+s</code> only applies to subdirectories created
after the command&rsquo;s taking effect. Subdirectories that are created before it are
not affected.</p></div></article><div class="license markdown-body"><blockquote><p>Unless otherwise noted, the content of this site is licensed under <a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a>.</p></blockquote></div></div><aside class="col-12 col-md-3 float-left sidebar"><div class="sidebar-item sidebar-pages"><h3>Pages</h3><ul><li><a href=/>Home</a></li><li><a href=/posts/about>About</a></li></ul></div><div class="sidebar-item sidebar-links"><h3>Links</h3><ul><li><a href=https://github.com target=_blank><span>Github</span></a></li></ul></div><div class="sidebar-item sidebar-tags"><h3>Tags</h3><div><span><a href=/tags/docker/>docker</a></span>
<span><a href=/tags/gem5/>gem5</a></span>
<span><a href=/tags/network/>network</a></span>
<span><a href=/tags/non-technical/>non-technical</a></span>
<span><a href=/tags/perl/>perl</a></span>
<span><a href=/tags/writting/>writting</a></span></div></div><div class="sidebar-item sidebar-toc"><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#ssh-server>SSH Server</a><ul><li><a href=#configure-the-ssh-server>Configure the SSH server</a></li></ul></li><li><a href=#set-up-git-server>Set up Git server</a><ul><li><a href=#configure-the-file-permission>Configure the file permission</a></li><li><a href=#set-the-directory-suitable-for-multi-user-environment>Set the directory suitable for multi-user environment</a></li></ul></li></ul></nav></div></aside></div><div class=btn><div class=btn-menu id=btn-menu><i class="iconfont icon-grid-sharp"></i></div><div class=btn-toggle-mode><i class="iconfont icon-contrast-sharp"></i></div><div class=btn-scroll-top><i class="iconfont icon-chevron-up-circle-sharp"></i></div></div><aside class=sidebar-mobile style=display:none><div class=sidebar-wrapper><div class="sidebar-item sidebar-pages"><h3>Pages</h3><ul><li><a href=/>Home</a></li><li><a href=/posts/about>About</a></li></ul></div><div class="sidebar-item sidebar-links"><h3>Links</h3><ul><li><a href=https://github.com target=_blank><span>Github</span></a></li></ul></div><div class="sidebar-item sidebar-tags"><h3>Tags</h3><div><span><a href=/tags/docker/>docker</a></span>
<span><a href=/tags/gem5/>gem5</a></span>
<span><a href=/tags/network/>network</a></span>
<span><a href=/tags/non-technical/>non-technical</a></span>
<span><a href=/tags/perl/>perl</a></span>
<span><a href=/tags/writting/>writting</a></span></div></div><div class="sidebar-item sidebar-toc"><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#ssh-server>SSH Server</a><ul><li><a href=#configure-the-ssh-server>Configure the SSH server</a></li></ul></li><li><a href=#set-up-git-server>Set up Git server</a><ul><li><a href=#configure-the-file-permission>Configure the file permission</a></li><li><a href=#set-the-directory-suitable-for-multi-user-environment>Set the directory suitable for multi-user environment</a></li></ul></li></ul></nav></div></div></aside></main><footer><div class="container-lg clearfix"><div class="col-12 footer"><span>&copy; 2022-2022
<a href=https://retrhelo.github.io>retrhelo</a>
| <a href=https://github.com/retrhelo/retrhelo.github.io>Source code</a>
| Powered by <a href=https://github.com/dsrkafuu/hugo-theme-fuji/ target=_blank>Fuji-v2</a> & <a href=https://gohugo.io/ target=_blank>Hugo</a></span></div></div></footer><script defer src=https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.27.0/components/prism-core.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.27.0/plugins/autoloader/prism-autoloader.min.js></script>
<script defer src=/assets/js/fuji.min.js></script></body></html>